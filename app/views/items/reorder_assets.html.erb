<%= render(Breadcrumbs::Component.new) do |component| %>
  <% component.with_breadcrumb(href: "/") { 'Home' } %>
  <% component.with_breadcrumb(href: items_path) { 'Items' } %>
  <% component.with_breadcrumb(href: item_path(@item, anchor: 'assets')) { @item.human_readable_name } %>
  <% component.with_breadcrumb { 'Assets' } %>
  <% component.with_breadcrumb { 'Arrange' } %>
<% end %>

<%= render(Header::Component.new) do |header| %>
  <%= header.with_title(tag: :h2) { 'Arrange Assets' } %>
<% end %>

<p>Drag an asset to adjust ordering or to mark it unordered.</p>

<hr>

<%= form_with url: item_path(@item), method: :patch, data: { controller: 'asset-ordering' } do |form| %>
  <h3 class="mt-2">Unarranged Assets</h3>
  <div id="unarranged-assets"
       data-action="dragstart->asset-ordering#dragstart dragover->asset-ordering#dragover dragenter->asset-ordering#dragenter drop->asset-ordering#drop dragend->asset-ordering#dragend"
       data-empty-message="Drag an Asset here to mark it unordered.">
    <% @unarranged_assets.each do |unarranged_asset| %>
      <%= render partial: 'order_asset_card',locals: { form: form, asset: unarranged_asset, arranged: false } %>
    <% end %>
  </div>

  <hr>

  <h3 class="mt-2">Arranged Assets</h3>
  <div id="arranged-assets"
       data-action="dragstart->asset-ordering#dragstart dragover->asset-ordering#dragover dragenter->asset-ordering#dragenter drop->asset-ordering#drop dragend->asset-ordering#dragend"
       data-empty-message="Drag an Asset here to order it.">
    <% @arranged_assets.each do |arranged_asset| %>
      <%= render partial: 'order_asset_card', locals: { form: form, asset: arranged_asset, arranged: true } %>
    <% end %>
  </div>
  <%= form.submit 'Save Arrangement', class: 'btn btn-primary mt-2' %>
  <%= link_to 'Reset', reorder_assets_item_path(@item), class: 'btn btn-secondary mt-2' %>
<% end %>
