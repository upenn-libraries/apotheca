<%= render(BreadcrumbsComponent.new) do |component| %>
  <% component.with_breadcrumb(href: "/") { 'Home' } %>
  <% component.with_breadcrumb(href: items_path) { 'Items' } %>
  <% component.with_breadcrumb(href: item_path(@item)) { @item.human_readable_name } %>
  <% component.with_breadcrumb { 'Assets' } %>
  <% component.with_breadcrumb(active: true) { 'New' } %>
<% end %>

<h1>New Asset</h1>
<%= render(Form::Component.new(name: 'new-asset', url: assets_path, method: :post)) do |form| %>
  <% form.with_error(@error) %>

  <% form.with_input_hidden(label: 'Item ID', value: @item.id, field: 'item_id') %>

  <% form.with_input_text(label: 'Label', value: @change_set.label, field: "asset[label]") %>
  <% form.with_input_text(label: 'Annotations', value: @change_set.annotations, field: "asset[annotations][][text]") %>

  <% form.with_section do |section| %>
    <% section.with_title { 'Transcription' } %>
    <% section.with_input_select(label: 'Mime Type',
                                 value: @change_set.transcriptions.first&.mime_type,
                                 field: "asset[transcriptions][][mime_type]",
                                 options: AssetChangeSet::TranscriptionChangeSet::VALID_MIME_TYPES) %>
    <% section.with_input_textarea(label: 'Contents',
                                   value: @change_set.transcriptions.first&.contents,
                                   field: "asset[transcriptions][][contents]") %>
  <% end %>

  <% form.with_submit('Save') %>
<% end %>