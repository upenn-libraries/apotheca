<%= render(Breadcrumbs::Component.new) do |component| %>
  <% component.with_breadcrumb(href: "/") do %>Home<% end %>
  <% component.with_breadcrumb(href: bulk_imports_path) do %>Imports<% end %>
  <% component.with_breadcrumb(href: bulk_import_path(@import.bulk_import)) do %><%= @import.bulk_import.id %><% end %>
  <% component.with_breadcrumb() do %>Import<% end %>
  <% component.with_breadcrumb(active: true, href: bulk_import_import_path(@import.bulk_import, @import)) do %>
    <%= @import.id %>
  <% end %>
<% end %>

<div class="d-flex justify-content-between align-items-center">
<h2>Import</h2>
<% if can?(:update, @import) && @import.may_cancel?  %>
  <%= render Form::Component.new(name: 'cancel_import', url: "", method: :patch) do |component| %>
    <% component.with_submit('Cancel', confirm: 'Do you really want to cancel this Import?',
                             variant: :secondary, class: 'btn-sm')
    %>
  <% end %>
<% end %>
</div>
<div class="row mb-3">
  <div class="col-6 col-lg-5 offset-lg-1">
    <dl class="row">
      <dt class="col-lg-5">State</dt>
      <dd class="col-lg-7">
        <%= @import.state.titlecase %>
      </dd>
      <dt class="col-lg-5">Processing Time</dt>
      <dd class="col-lg-7"><%= @import.duration ? distance_of_time(@import.duration) : '[Unknown]' %></dd>
        <dt class="col-lg-5">Unique Identifier</dt>
        <dd class="col-lg-7"><%= @import.resource_identifier %></dd>
    </dl>
  </div>
  <div class="col-6 col-lg-5">
    <dl class="row">
      <dt class="col-lg-4">ID</dt>
      <dd class="col-lg-8"><%= @import.id %></dd>
      <dt class="col-lg-4">Created At</dt>
      <dd class="col-lg-8"><%= @import.created_at.to_fs(:display) %></dd>
      <dt class="col-lg-4">Updated At</dt>
      <dd class="col-lg-8"><%= @import.updated_at.to_fs(:display) %></dd>
    </dl>
  </div>
</div>


<% unless @import.process_errors.blank? %>
  <h4>Errors</h4>
  <ul class="list-group mb-3">
    <% @import.process_errors.each do |error| %>
      <li class="list-group-item list-group-item-warning"><%= error %></li>
    <% end %>
  </ul>
<% end %>

<h4>Import Data</h4>
<pre class="bg-light"><%= JSON.pretty_generate(@import.import_data) %></pre>
